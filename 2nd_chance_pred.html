<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="./logos/favicon.png">
    <title>Prediction Form - Euro 2024</title>
    <style>
        body {
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            margin: 10px;
            background-color: #1e1e1e;
            color: #7c7a7a;
        }

        select,
        input[type="text"] {
            width: 200px;
            background-color: #6b6a6a;
            color: #fff;
            border: 1px solid #444444;
            margin-bottom: 10px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
        }

        .predictions {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .prediction-section {
            flex: 1;
            min-width: 300px;
        }

        .bold-text {
            font-weight: bold;
        }

        .menu-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .menu {
            list-style-type: none;
            padding: 0;
        }

        .menu li {
            display: inline;
            margin-left: 20px;
        }

        .menu li a {
            color: #7c7a7a;
            text-decoration: none;
            font-weight: bold;
        }

        .footnote {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 0.8em;
            color: #484747;
            background-color: #1e1e1e;
            padding: 5px;
            border-radius: 3px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body>
    <div class="menu-container">
        <ul class="menu">
            <li><a href="./ranks.html">Rankings</a></li>
            <li><a href="./comp2euros.html">Euro2024 Results</a></li>
            <li><a href="./all_predictions.html">Game by Game Points</a></li>
            <li><a href="./pvsp.html">Player vs Player</a></li>
            <li><a href="./all_predictions.html">Download All Predictions</a></li>
            <li><a href="./predictform.html">Prediction Form</a></li>
            <li><a href="./rules.html">Points System</a></li>
            <li><a href="./widget.html">Widget</a></li>
        </ul>
    </div>
    <div class="container">
        <h1>Prediction Form - Euro 2024</h1>
        <label for="participant">Select Participant:</label>
        <select id="participant" onchange="loadParticipantData()">
            <option value="">Select...</option>
        </select>
        <div class="predictions">
            <div class="prediction-section" id="groupStageResults">
                <h2>Group Stage Results</h2>
                <!-- Group Stage Results will be populated here -->
            </div>
            <div class="prediction-section" id="knockoutStageResults">
                <h2>Knockout Stage Predictions</h2>
                <!-- Knockout Stage Predictions will be populated here -->
            </div>
        </div>
        <div>
            <h2>Quarter-Final to Final Predictions</h2>
            <div>
                <label for="quarterFinal">Quarter Final:</label>
                <input type="text" id="quarterFinal" placeholder="Quarter Final Prediction">
            </div>
            <div>
                <label for="semiFinal">Semi Final:</label>
                <input type="text" id="semiFinal" placeholder="Semi Final Prediction">
            </div>
            <div>
                <label for="final">Final:</label>
                <input type="text" id="final" placeholder="Final Prediction">
            </div>
            <div>
                <label for="champion">Champion:</label>
                <input type="text" id="champion" placeholder="Champion Prediction">
            </div>
            <button onclick="savePredictions()">Save Predictions</button>
        </div>
    </div>
    <div class="footnote">
        &copy; 2024. Website created by Nima N.
    </div>

    <script>
        const flags = {
            'Germany': 'https://flagcdn.com/w20/de.png',
            'Scotland': 'https://flagcdn.com/w20/gb-sct.png',
            'Hungary': 'https://flagcdn.com/w20/hu.png',
            'Switzerland': 'https://flagcdn.com/w20/ch.png',
            'Spain': 'https://flagcdn.com/w20/es.png',
            'Croatia': 'https://flagcdn.com/w20/hr.png',
            'Italy': 'https://flagcdn.com/w20/it.png',
            'Albania': 'https://flagcdn.com/w20/al.png',
            'Serbia': 'https://flagcdn.com/w20/rs.png',
            'England': 'https://flagcdn.com/w20/gb-eng.png',
            'Slovenia': 'https://flagcdn.com/w20/si.png',
            'Denmark': 'https://flagcdn.com/w20/dk.png',
            'Poland': 'https://flagcdn.com/w20/pl.png',
            'Netherlands': 'https://flagcdn.com/w20/nl.png',
            'Austria': 'https://flagcdn.com/w20/at.png',
            'France': 'https://flagcdn.com/w20/fr.png',
            'Romania': 'https://flagcdn.com/w20/ro.png',
            'Ukraine': 'https://flagcdn.com/w20/ua.png',
            'Belgium': 'https://flagcdn.com/w20/be.png',
            'Slovakia': 'https://flagcdn.com/w20/sk.png',
            'Turkey': 'https://flagcdn.com/w20/tr.png',
            'Georgia': 'https://flagcdn.com/w20/ge.png',
            'Portugal': 'https://flagcdn.com/w20/pt.png',
            'Czechia': 'https://flagcdn.com/w20/cz.png'
        };

        const abbreviations = {
            'Germany': 'GER',
            'Scotland': 'SCO',
            'Hungary': 'HUN',
            'Switzerland': 'SUI',
            'Spain': 'ESP',
            'Croatia': 'CRO',
            'Italy': 'ITA',
            'Albania': 'ALB',
            'Serbia': 'SRB',
            'England': 'ENG',
            'Slovenia': 'SVN',
            'Denmark': 'DEN',
            'Poland': 'POL',
            'Netherlands': 'NED',
            'Austria': 'AUT',
            'France': 'FRA',
            'Romania': 'ROU',
            'Ukraine': 'UKR',
            'Belgium': 'BEL',
            'Slovakia': 'SVK',
            'Turkey': 'TUR',
            'Georgia': 'GEO',
            'Portugal': 'POR',
            'Czechia': 'CZE'
        };

        function populateDropdowns(participants) {
            const participantSelect = document.getElementById('participant');
            participants.forEach(participant => {
                const option = document.createElement('option');
                option.value = participant.scores;
                option.text = participant.name;
                participantSelect.add(option);
            });
        }

        function loadParticipantData() {
            const participantSelect = document.getElementById('participant');
            const selectedscores = participantSelect.value;
            const groupStageResultsDiv = document.getElementById('groupStageResults');
            const knockoutStageResultsDiv = document.getElementById('knockoutStageResults');
            groupStageResultsDiv.innerHTML = 'Loading...';
            knockoutStageResultsDiv.innerHTML = 'Loading...';
            if (selectedscores) {
                fetch(selectedscores)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response.text();
                    })
                    .then(data => {
                        const rows = data.split('\n').map(row => row.split(','));
                        let groupStageHTML = '<h3>Group Stage Results</h3><table>';
                        let knockoutStageHTML = '<h3>Knockout Stage Predictions</h3><table>';
                        rows.forEach(row => {
                            groupStageHTML += '<tr>';
                            knockoutStageHTML += '<tr>';
                            row.forEach((cell, index) => {
                                const cellContent = cell.trim();
                                const flagImg = flags[cellContent] ? `<img src="${flags[cellContent]}" class="flag"> ` : '';
                                const abbreviation = abbreviations[cellContent] ? abbreviations[cellContent] : cellContent;
                                const boldText = [
                                    'Group Stage', 'Group A', 'Group B', 'Group C', 'Group D', 'Group E', 'Group F',
                                    'KO Stage', 'Round of 16', 'Quarterfinals', 'Semifinals', 'Final',
                                    'Top Goalscorer', 'Best Goalkeeper', 'Player of Tournament', 'Top Players'
                                ];
                                const cellClass = boldText.includes(cellContent) ? 'bold-text' : '';
                                if (index < 4) {
                                    groupStageHTML += `<td class="${cellClass}">${flagImg}${abbreviation}</td>`;
                                } else {
                                    knockoutStageHTML += `<td class="${cellClass}">${flagImg}${abbreviation}</td>`;
                                }
                            });
                            groupStageHTML += '</tr>';
                            knockoutStageHTML += '</tr>';
                        });
                        groupStageHTML += '</table>';
                        knockoutStageHTML += '</table>';
                        groupStageResultsDiv.innerHTML = groupStageHTML;
                        knockoutStageResultsDiv.innerHTML = knockoutStageHTML;
                    })
                    .catch(error => {
                        groupStageResultsDiv.innerHTML = `Error loading predictions: ${error.message}`;
                        knockoutStageResultsDiv.innerHTML = `Error loading predictions: ${error.message}`;
                        console.error('Error details:', error);
                    });
            } else {
                groupStageResultsDiv.innerHTML = '';
                knockoutStageResultsDiv.innerHTML = '';
            }
        }

        function savePredictions() {
            const participantSelect = document.getElementById('participant');
            const participantName = participantSelect.options[participantSelect.selectedIndex].text;
            const quarterFinal = document.getElementById('quarterFinal').value;
            const semiFinal = document.getElementById('semiFinal').value;
            const final = document.getElementById('final').value;
            const champion = document.getElementById('champion').value;
            const data = [
                ['Participant', 'Quarter Final', 'Semi Final', 'Final', 'Champion'],
                [participantName, quarterFinal, semiFinal, final, champion]
            ];
            const csvContent = 'data:text/csv;charset=utf-8,' + data.map(e => e.join(',')).join('\n');
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', `${participantName}_predictions.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Fetch the JSON scores and populate dropdowns on page load
        window.onload = function () {
            fetch('./jsons/participants.json')
                .then(response => response.json())
                .then(data => populateDropdowns(data.participants))
                .catch(error => console.error('Error loading participants list:', error));
        };
    </script>
</body>

</html>